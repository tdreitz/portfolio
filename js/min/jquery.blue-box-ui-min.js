!function($){$.blueBoxUiPage=function(i){this.__construct(i)},$.blueBoxUiPage.settings={speed:500,easing:"cubic-bezier(.5,.5,.5,.5)",primaryViewSpeedDev:1.5,primaryViewExitPos:"-20%",blueBoxLoaderIcon:null,blueBoxScriptsLoader:null},$.blueBoxUiPage.prototype={__construct:function(i){return this.options=$.extend(!0,{},$.blueBoxUiPage.settings,i),this.blueBoxLoaderIcon=this.options.blueBoxLoaderIcon,this.lastScrollPosition=$(window).scrollTop(),this.currUrl=window.location.href,this.prevUrl=null,this.headerFixedElements=$("#mobile-menu-buttons"),this.previousHeaderFixedElements=!1,this.leftViewFixedElements=!1,this.rightViewFixedElements=!1,this.closeViewButton=$("#bb-ui-close-primary-view"),this.footerElement=$("#bb-footer"),this.setupViews()===!1?!1:(this.setupDimensions(),void this.bindListeners())},setupViews:function(){return this.activeView=$(".bb-ui-view.primary").blueBoxUiView(),this.activeView.size()<1?!1:(this.activeView.hasClass("left")?(this.activeViewPosition="left",this.leftView=this.activeView,this.rightView=$('<div class="bb-ui-view right" />').blueBoxUiView(),this.leftView.after(this.rightView),this.inactiveView=this.rightView,this.leftViewUrl=this.currUrl,this.rightViewUrl=""):(this.activeViewPosition="right",this.leftView=$('<div class="bb-ui-view left" />').blueBoxUiView(),this.rightView=this.activeView,this.rightView.before(this.leftView),this.inactiveView=this.leftView,this.leftViewUrl="",this.rightViewUrl=this.currUrl),void 0===this.leftView.attr("id")&&this.leftView.attr("id","bb-ui-view-"+uniqid()),void(void 0===this.rightView.attr("id")&&this.rightView.attr("id","bb-ui-view-"+uniqid())))},setupDimensions:function(){this.documentWidth=$(document).width(),this.documentHeight=$(document).height(),this.windowHeight=$(window).height(),this.footerHeight=this.footerElement.outerHeight()},openPrevView:function(i){var e=this;this.activeView=this.leftView,this.inactiveView=this.rightView,this.prevViewPosition=this.activeViewPosition,this.activeViewPosition="left",this.start(),this.leftView.css({top:0,position:"fixed",display:"block",width:this.documentWidth,height:"100%",x:this.options.primaryViewExitPos,zIndex:-1}),this.leftView.blueBoxUiView("overlay",function(){this.css({opacity:1,zIndex:9})}),this.rightView.css({zIndex:10}),this.blueBoxLoaderIcon.icon.css({display:"block",position:"fixed",x:-(this.documentWidth/2),top:"50%",left:"50%",marginLeft:-30,zIndex:999}),this.footerElement.css({zIndex:4}),$("body").trigger("bb-ui-view-change-prev");var t=$("#bb-page-heading");t.size()>0&&t.css({position:"absolute",top:t.offset().top}).transit({opacity:.5},this.options.speed,function(){$(this).css({opacity:"",transform:""})}),this.blueBoxLoaderIcon.icon.transit({x:0},this.options.speed,this.options.easing),this.leftView.transit({x:0},this.options.speed/this.options.primaryViewSpeedDev,this.options.easing),this.rightView.transit({x:"100%"},this.options.speed,this.options.easing,function(){e.loadCurrentView(i)}),this.footerElement.transit({x:"100%"},this.options.speed-50,this.options.easing,function(){e.leftView.css({zIndex:""}),$(this).css({zIndex:"",transform:""})})},openNextView:function(i){var e=this;this.activeView=this.rightView,this.inactiveView=this.leftView,this.prevViewPosition=this.activeViewPosition,this.activeViewPosition="right",this.start(),this.rightView.css({top:0,position:"fixed",display:"block",width:this.documentWidth,height:"100%",x:"100%",zIndex:10}),this.rightView.blueBoxUiView("overlay",function(){this.css({opacity:1,zIndex:10})}),this.leftView.css({zIndex:3}),this.blueBoxLoaderIcon.icon.css({display:"block",position:"fixed",x:this.documentWidth,top:"50%",left:"50%",marginLeft:-30,zIndex:999}),$("body").trigger("bb-ui-view-change-next"),this.blueBoxLoaderIcon.icon.transit({x:0},this.options.speed,this.options.easing),this.leftView.transit({x:this.options.primaryViewExitPos},this.options.speed*this.options.primaryViewSpeedDev,this.options.easing),this.rightView.transit({x:0},this.options.speed,this.options.easing,function(){e.loadCurrentView(i)}),this.footerElement.transit({x:this.options.primaryViewExitPos},this.options.speed*this.options.primaryViewSpeedDev,this.options.easing,function(){$(this).css({zIndex:"",transform:""})})},openSameView:function(i){var e=this;this.prevViewPosition=this.activeViewPosition;var t=this.lastScrollPosition;if(this.start(this.activeViewPosition),!$("body").hasClass("mobile-menu-active")){var s=$(window).scrollTop(),o=this.footerHeight-(this.documentHeight-(this.windowHeight+s));o>0&&$("html, body").animate({scrollTop:s-o},.9*this.options.speed)}$("body").trigger("bb-ui-view-change-same"),this.activeView.blueBoxUiView("getContent").transit({opacity:0},this.options.speed,function(){e.blueBoxLoaderIcon.center(),e.loadCurrentView(i),e.lastScrollPosition=t})},loadCurrentView:function(i){var e=this;void 0!==i&&i?(this.pushUrlWindowState(i),"left"===this.activeViewPosition?this.leftViewUrl=this.getRealUrl(i):this.rightViewUrl=this.getRealUrl(i),this.lastScrollPosition=$(window).scrollTop(),$(window).scrollTop(0),$("body").trigger("blue-box-before-content-loaded"),$.ajax({url:i,success:function(i){var t=e.getElementsFromString(i);document.title=t.head.children("title").text(),t.body.removeClass("not-loaded"),$("body").attr("class",t.body.attr("class"));var s=t.body.find(".bb-ui-view.primary").blueBoxUiView();return s.size()<1?void e.error():(s.blueBoxUiView("overlay",function(){this.css({opacity:1,zIndex:10})}),e.activeView.html(s.html()),e.activeView.blueBoxUiView("refresh"),void e.end(t.body))}})):("left"===this.activeViewPosition?this.pushUrlWindowState(this.leftViewUrl):this.pushUrlWindowState(this.rightViewUrl),this.end(!1))},start:function(i){var e=this;this.headerFixedElements.transit({opacity:0,x:0},.5*this.options.speed),this.closeViewButton.transit({opacity:0,display:"block"},this.options.speed,function(){$(this).css({display:"none",zIndex:""})}),this.activeView.blueBoxUiView("heading",function(){i===e.activeViewPosition?this.transit({y:-this.outerHeight()},e.options.speed,function(){$(this).css({opacity:""})}):this.css({opacity:0})})},end:function(i){var e=this;if(this.activeView.addClass("primary"),i!==!1&&i.size()>0){$(window).scrollTop(0);var t=i.children("#"+e.headerFixedElements.attr("id"));t.size()>0&&("right"===e.activeViewPosition&&"right"!==e.prevViewPosition?e.leftViewFixedElements=e.headerFixedElements.clone():e.rightViewFixedElements=e.headerFixedElements.clone(),e.headerFixedElements.html(t.html())),this.options.blueBoxScriptsLoader.reload(this.activeView.attr("id"),function(){$(window).scrollTop(0),e.displayViewsOnEnd(),$(window).trigger("resize"),$("body").trigger("bb-ui-view-changed")})}else"left"===this.activeViewPosition&&this.leftViewFixedElements!==!1?(this.headerFixedElements.html(this.leftViewFixedElements.html()),this.leftViewFixedElements.remove(),this.leftViewFixedElements=!1):this.rightViewFixedElements!==!1&&(this.headerFixedElements.html(this.rightViewFixedElements.html()),this.rightViewFixedElements.remove(),this.rightViewFixedElements=!1),this.displayViewsOnEnd(),$(window).scrollTop(this.lastScrollPosition),$("body").trigger("bb-ui-view-changed"),$(window).trigger("resize")},displayViewsOnEnd:function(){var i=this;i.inactiveView.css({position:"",width:"",height:"",display:"none",zIndex:"",transform:""}).removeClass("primary"),i.activeView.css({position:"",top:"",position:"",display:"",width:"",height:"",zIndex:"",transform:""}).addClass("primary"),i.headerFixedElements.transit({opacity:1},i.options.speed,function(){$(this).css({opacity:""})}),"right"===i.activeViewPosition&&i.closeViewButton.css({opacity:0,display:"block",zIndex:3}).transit({opacity:1},i.options.speed),i.activeView.blueBoxUiView("getOverlay").transit({opacity:0},i.options.speed,function(){$(this).css({opacity:"",zIndex:""})}),i.activeView.blueBoxUiView("heading",function(){this.size()>0?this.transit({y:0,opacity:1},i.options.speed,function(){$(this).css({opacity:"",transform:""})}):i.activeView.blueBoxUiView("getContainer").css("paddingTop","")}),i.blueBoxLoaderIcon.icon.hide()},error:function(){},getElementsFromString:function(i){var e=i.match(/<\s*head.*>[\s\S]*<\s*\/head\s*>/gi).join("");e=$(e.replace(/<\s*head/gi,"<div"));var t=i.match(/<\s*body.*>[\s\S]*<\s*\/body\s*>/gi).join("");return t=$(t.replace(/<\s*body/gi,"<div")),{head:e,body:t}},getRealUrl:function(i){var e=i;return("index.html"===i||"index.php"===i)&&(e=gummBaseUrl),e},pushUrlWindowState:function(i){window.history.pushState({path:i},"",i),this.popStateListeners!==!0&&(this.popStateListeners=!0,this.bindPopStateBackListener())},bindPopStateBackListener:function(){var i=this;$(window).on("popstate",function(e){var t=i.getRealUrl(location.href);0===gummBaseUrl.indexOf(t)&&"right"===i.activeViewPosition?i.openPrevView(location.href):"right"===i.activeViewPosition&&i.openSameView(location.href)})},bindListeners:function(){var i=this;this.closeViewButton.on("click",function(e){e.preventDefault(),e.stopPropagation(),i.openPrevView()}),$(document).on("click","a",function(e){var t=$(this),s=i.getRealUrl(t.attr("href")),o=t.parent();if(!o.parent().hasClass("footer-social-links")){if($(this).hasClass("outside-link"))return void console.log(">passed");if("mobile-menu-button"===$(this).attr("id"))return void console.log(">passed");if(e.preventDefault(),console.log(">passed"),s===window.location.href)return void console.log(">passed");if("#"===s);else if(0===s.indexOf("#")){var n=$(s);n.size()>0&&$("html, body").animate({scrollTop:n.offset().top},2*i.options.speed,function(){window.location.hash=s})}else s.indexOf("#")>0||(0===gummBaseUrl.indexOf(s)?i.leftViewUrl.length>0?i.openPrevView():i.openPrevView(s):"left"===i.activeViewPosition?i.openNextView(s):i.openSameView(s))}}),$(window).on("resize",function(){i.setupDimensions()})}},$.blueBoxUiView=function i(e,t,s){this.element=$(s),this.__construct(e,t)},$.blueBoxUiView.prototype={__construct:function(i,e){this.init()},init:function(){this.container=this.element.children(".bb-ui-view-container"),this.container.size()<1?this.initialize():this.content=this.container.children(".bb-ui-view-content"),this.heading=this.element.children("#bb-page-heading"),this.overlay=this.element.children(".bb-ui-view-loading-overlay"),this.overlay.size()<1&&(this.overlay=$('<div class="bb-ui-view-loading-overlay" />'),this.element.prepend(this.overlay))},initialize:function(){this.container=$('<div class="bb-ui-view-container" />'),this.content=$('<div class="bb-ui-view-content" />'),this.overlay=$('<div class="bb-ui-view-loading-overlay" />'),this.element.append(this.overlay),this.container.append(this.content),this.element.append(this.container)}},$.fn.blueBoxUiView=function i(e,t){var s=this;return this.each(function(){var i=$.data(this,"blueBoxUiView");if(i)switch(e){case"content":t.apply(i.content);break;case"container":t.apply(i.content);break;case"heading":t.apply(i.heading);break;case"overlay":t.apply(i.overlay);break;case"getContent":s=i.content;break;case"getContainer":s=i.container;break;case"getHeading":s=i.heading;break;case"getOverlay":s=i.overlay;break;case"refresh":i.init()}else $.data(this,"blueBoxUiView",new $.blueBoxUiView(e,t,this))}),s}}(jQuery);